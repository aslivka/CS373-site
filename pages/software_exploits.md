## Week 4 - Software Vulnerabilities and Exploits              
### Introduction
We will cover some major types of software exploits used for gaining unathorized access to computer systems. 
After that, I included a summary of a Stack overflow exploit Lab, with screenshots and commands.

### Manipulating Software 
*	Finding “bugs” which alter behavior of the program. They are commonly referred to as ***exploits***.
*	Taking advantage of a misconfiguration or poor programming practice

### Flaw Classes and Vulnerabilities
*	***Configuration*** – weak password
*	***Logic*** – authorization issues
*	***Storage*** – inadequate encryption
*	***Input validation*** - memory corruption and injection

### Memory corruption 
This is accessing memory in an invalid way which results in an undefined behavior (which we’re looking to control). 
The labs for this week focused on this type of exploitation, with memory located in stack or heap.
Types: 
*	Lifetime control 
*	Uninitialized memory
*	Array index calculations
*	buffer length calculations 

### Exploitation
The general structure of an ***exploit*** consists of 2 things:
* Vulnerability trigger - invokes the software bug to obtain control of the program
* Payload - action to be performed when control is obtained. Also referred to as ***shellcode***, usually assembly code to execute a shell.

### Code Execution
1.	Crash Triage

    a.	What do we control? 

        i.	registers that contain and point to attacker-controlled data

        ii.	is controlled data on Stack or Heap

    b.	Where are we in the execution of the program?

        i.	Where is the vulnerability? 

        ii.	Was the crash caused by an exploit mitigation?
        
2.	Determine the return address offset - Figure out the offset to EIP overwrite
3.	Position our shellcode
4.	Find the address of our shellcode
See example of exploit embedded as part of stack.
![alt text](../images/w4_stack_execution.jpg "Stack exploit execution")


```
attrib +r +s +h c:\qusla.exe
```
Then, it adds qusla.exe to Windows startup by creating the appropriate registry key at HKLM\Software\Microsoft\Windows\CurrentVersion\Run
*	Finally, it changes start page for Internet explorer to ***http://www.3392.cn***.
See FileInsight screenshot for condensed string dump of program’s contents
![alt text](../images/w3_insight_shot0.jpg "FileInsight screenshot of malware")



* It created ***Dx.bat*** file, a batch file that runs commands
![alt text](../images/w3_cuckoo_shot1.jpg "Cuckoo screenshot 1")
 


[Go Home](../index.md) 
